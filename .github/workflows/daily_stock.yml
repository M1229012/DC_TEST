name: Manual Stock Report

on:
  workflow_dispatch: # 手動觸發按鈕

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      # 1. 升級 pip (這步很重要，避免安裝過程出錯)
      - name: Upgrade pip
        run: |
          python -m pip install --upgrade pip setuptools wheel

      # 2. 安裝乾淨的套件清單
      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      # 3. 執行程式 (檔名有空白，這裡已經幫你加了雙引號)
      - name: Run Analysis Script
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK_TEST }}
        run: |
          python "DC_One-page candlestick chart.py"
